<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è¨˜å¸³è¨­å®šï½œSuperTool</title>

  <!-- è·¯å¾‘æ³¨æ„ï¼šæ­¤æª”ä½æ–¼ admin/ -->
  <link rel="icon" type="image/png" href="../assets/img/supertool-favicon.png" />
  <link rel="stylesheet" href="../assets/css/style.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <style>
    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ é ‚éƒ¨å°è¦½åˆ— â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .top{
      background:#17202a; color:#fff; padding:.6rem 1rem;
      display:flex; align-items:center; justify-content:space-between;
      border-bottom:1px solid #2b313a; position:sticky; top:0; z-index:50;
    }
    .brand{ display:flex; align-items:center; gap:.5rem; color:#fff; text-decoration:none; font-weight:800; }
    .brand img{ height:28px; }
    .top .nav button,.top .nav .btn{ margin-right:.35rem; }

    /* æ‰‹æ©Ÿæ¼¢å ¡ */
    .hamburger{ display:none; width:40px;height:34px;border:1px solid #2b313a;border-radius:8px;background:#111722;cursor:pointer;margin-left:8px; }
    .hamburger span{ display:block;height:4px;margin:5px 7px;background:#fff;border-radius:999px;transition:.25s; }
    .hamburger.active span:nth-child(1){ transform:translateY(9px) rotate(45deg); }
    .hamburger.active span:nth-child(2){ opacity:0; }
    .hamburger.active span:nth-child(3){ transform:translateY(-9px) rotate(-45deg); }
    @media (max-width: 992px){
      .hamburger{ display:inline-block; }
      .top .nav{
        display:none; position:absolute; left:0; right:0; top:100%;
        background:#17202a; border-top:1px solid #2b313a; padding:12px;
        box-shadow:0 10px 30px rgba(0,0,0,.35);
      }
      .top .nav.open{
        display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:8px;
      }
      .top .nav .btn,.top .nav button{ width:100%; border-radius:10px; }
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ èƒŒæ™¯æ¼¸å±¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gradient-wrap{
      background: linear-gradient(135deg,#1e3a8a 0%,#2563eb 20%,#7e22ce 40%,#db2777 60%,#f97316 80%,#fde047 100%);
      background-size:300% 300%;
      animation: gradientShift 10s ease-in-out infinite;
      min-height:100vh; padding-bottom:56px;
    }
    @keyframes gradientShift{
      0%{ background-position:0% 50% } 50%{ background-position:100% 50% } 100%{ background-position:0% 50% }
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç‰ˆé¢ï¼šå·¦å´ / å³å´ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .settings-shell{
      max-width:1200px; margin:0 auto; padding:28px 16px;
      display:grid; grid-template-columns: 280px 1fr; gap:22px;
    }
    @media (max-width:992px){ .settings-shell{ grid-template-columns:1fr; } }

    /* å·¦å´åŠé€æ˜é¢æ¿ */
    .side-panel{
      backdrop-filter: blur(6px);
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.08);
      border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,.25);
      color:#fff; overflow:hidden;
    }
    .side-title{ padding:14px 16px; font-weight:800; font-size:18px; border-bottom:1px solid rgba(255,255,255,.08); }
    .side-menu{ list-style:none; margin:0; padding:8px; }
    .side-menu li{ margin:6px 0; }
    .side-menu a{
      display:block; padding:10px 12px; border-radius:8px; color:#e5e7eb; text-decoration:none;
      background: rgba(255,255,255,.04); transition: background .25s;
    }
    .side-menu a:hover{ background: rgba(255,255,255,.08); }
    .side-menu a.active{ background:#2563eb; color:#fff; }

    /* å³å´å¡ç‰‡ */
    .content-card{
      background: linear-gradient(145deg,#0f172a,#1e293b);
      color:#fff; border:2px solid transparent;
      border-image: linear-gradient(90deg,#60a5fa,#a855f7,#f472b6) 1;
      border-radius:14px; padding:20px; box-shadow:0 8px 26px rgba(0,0,0,.45);
    }
    .content-card h2{
      margin:0 0 8px 0; font-size:22px; font-weight:800;
      background: linear-gradient(90deg,#60a5fa,#a855f7,#f472b6);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    }
    .page-slot{ display:grid; gap:16px; }

    /* ğŸ”’ æŠŠå…§é é‚£æ’å°é ç±¤è—èµ·ä¾†ï¼Œä½†åŠŸèƒ½ä¾èˆŠå¯åœ¨ JS å…§è§¸ç™¼ */
    #app .nav.nav-tabs,
    #app .nav.nav-pills,
    #app .quick-tabs,
    #app .mode-switch,
    #app .subtabs { display:none !important; }
  </style>
</head>
<body>

  <!-- é ‚éƒ¨å°è¦½ -->
  <header class="top">
    <a class="brand" href="../index.html#dashboard">
      <img src="../assets/img/supertool-favicon.png" alt="SuperTool">
      <span>SuperTool</span>
    </a>

    <button id="menuToggle" class="hamburger" aria-label="é–‹å•Ÿé¸å–®" aria-controls="mainNav" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>

    <nav class="nav" id="mainNav">
      <button onclick="location.href='../index.html#dashboard'">é¦–é </button>
      <button onclick="location.href='../index.html#auth'">å¸³è™Ÿ</button>
      <button onclick="location.href='../book.html'">è¨˜å¸³</button>
      <button onclick="location.href='./accounting-settings.html#ledgers'">æˆ‘çš„</button>
      <button onclick="location.href='../index.html#acct_detail'">æ˜ç´°</button>
      <button onclick="location.href='../index.html#acct_analysis'">åˆ†æ</button>
      <button onclick="location.href='../cart-demo.html'">è³¼ç‰©</button>
      <button onclick="location.href='../index.html#admin'">å¾Œå°</button>
      <button onclick="location.href='../index.html#settings'">è¨­å®š</button>
      <button onclick="location.href='../index.html#backup'">å‚™ä»½</button>
      <button class="btn btn-primary" onclick="location.href='../stock/stocks.html'">è‚¡ç¥¨</button>
      <button class="btn btn-outline-light" onclick="alert('è¯çµ¡æˆ‘å€‘ï¼šä¹‹å¾Œå¯ä¸²æ¥è¡¨å–®')">è¯çµ¡æˆ‘å€‘</button>
    </nav>
  </header>

  <!-- ä¸»è¦èƒŒæ™¯ -->
  <div class="gradient-wrap">
    <div class="settings-shell">

      <!-- å·¦å´é¸å–® -->
      <aside class="side-panel">
        <div class="side-title">è¨˜å¸³è¨­å®š</div>
        <ul class="side-menu" id="sideMenu">
          <li><a href="#ledgers" class="active" data-key="ledgers">ç®¡ç†å¸³æœ¬</a></li>
          <li><a href="#budget"  data-key="budget">ç®¡ç†é ç®—</a></li>
          <li><a href="#currency" data-key="currency">ç®¡ç†è²¨å¹£</a></li>
          <li><a href="#categories" data-key="categories">ç®¡ç†é¡å‹</a></li>
          <li><a href="#chat" data-key="chat">èŠå¤©è¨­å®š</a></li>
          <li><a href="#general" data-key="general">ä¸€èˆ¬è¨­å®š</a></li>
        </ul>
      </aside>

      <!-- å³å´å…§å®¹ -->
      <main class="page-slot">
        <section class="content-card">
          <h2>èŠå¤©è¨­å®š</h2>
          <div id="app"></div>
        </section>
      </main>

    </div>
  </div>

  <!-- æ—¢æœ‰ SPA è…³æœ¬ï¼ˆä¸è¦å‹•ï¼‰ -->
  <script type="module" src="../assets/js/pages/accounting-settings.js"></script>

  <script>
    /* æ‰‹æ©Ÿï¼šæ¼¢å ¡é–‹é—œï¼ˆåŸæ¨£ä¿ç•™ï¼‰ */
    (function(){
      const toggle = document.getElementById('menuToggle');
      const nav = document.getElementById('mainNav');
      if(!toggle || !nav) return;
      const mq = window.matchMedia('(max-width: 992px)');
      function closeMenu(){
        nav.classList.remove('open');
        toggle.classList.remove('active');
        toggle.setAttribute('aria-expanded','false');
      }
      toggle.addEventListener('click', ()=>{
        const opened = nav.classList.toggle('open');
        toggle.classList.toggle('active', opened);
        toggle.setAttribute('aria-expanded', opened ? 'true' : 'false');
      });
      window.addEventListener('resize', ()=>{ if(!mq.matches) closeMenu(); });
      document.addEventListener('click', (e)=>{
        if (!mq.matches) return;
        if (e.target === toggle || toggle.contains(e.target)) return;
        if (!nav.contains(e.target)) closeMenu();
      });
    })();

    /* å·¦å´é¸å–® â†’ è§¸ç™¼å³å´ #app å…§åŸæœ¬çš„ã€Œé‚£æ’æŒ‰éˆ•/é ç±¤ã€ */
    (function(){
      const menu = document.getElementById('sideMenu');
      const app  = document.getElementById('app');

      // ä¾ key å°æ‡‰ #app å…§æŒ‰éˆ•æ–‡å­—ï¼ˆç›¡é‡å¯¬é¬†åŒ¹é…ï¼‰
      const textMap = {
        ledgers:   /ç®¡ç†å¸³æœ¬|å¸³æœ¬/i,
        budget:    /ç®¡ç†é ç®—|é ç®—/i,
        currency:  /è²¨å¹£|åŒ¯ç‡/i,
        categories:/ç®¡ç†é¡å‹|åˆ†é¡|é¡å‹/i,
        chat:      /èŠå¤©è¨­å®š|èŠå¤©/i,
        general:   /ä¸€èˆ¬è¨­å®š|ä¸€èˆ¬/i
      };

      // æ‰¾åˆ° #app å…§å°æ‡‰çš„æŒ‰éˆ•/é ç±¤ä¸¦é»æ“Š
      function clickInsideAppByKey(key){
        const re = textMap[key];
        if(!re) return;

        // å€™é¸ï¼šæŒ‰éˆ•/é€£çµ/é ç±¤
        const candidates = app.querySelectorAll('button, a, [role="tab"], .tab, .pill');
        for (const el of candidates){
          const t = (el.textContent || '').trim();
          if (re.test(t)){
            el.click();
            return true;
          }
        }
        return false;
      }

      // æ›´æ–°å·¦å´ active æ¨£å¼
      function setActiveKey(key){
        menu.querySelectorAll('a').forEach(a=>{
          a.classList.toggle('active', a.dataset.key===key);
        });
      }

      // å·¦å´é»æ“Š â†’ è§¸ç™¼ #app å°æ‡‰è¡Œç‚º
      menu.addEventListener('click', (e)=>{
        const a = e.target.closest('a[data-key]');
        if(!a) return;
        e.preventDefault();
        const key = a.dataset.key;
        // è¨­ hashï¼ˆè‹¥ä½ çš„ SPA æœƒç”¨åˆ°ï¼‰
        location.hash = '#'+key;
        setActiveKey(key);
        // å˜—è©¦é»æ“Š #app å…§å°æ‡‰æ§åˆ¶
        if (!clickInsideAppByKey(key)){
          // å¦‚æœ #app é‚„æ²’æ¸²æŸ“å¥½ï¼Œç­‰ä¸€ä¸‹å†è©¦
          setTimeout(()=>clickInsideAppByKey(key), 120);
        }
      });

      // ç›£çœ‹ #app å…§å®¹è®Šå‹•ï¼ˆæ¸²æŸ“å®Œæˆå¾Œå†ç¶ä¸€æ¬¡ï¼‰
      const mo = new MutationObserver(()=> {
        const key = (location.hash||'').replace('#','') || 'ledgers';
        clickInsideAppByKey(key);
        setActiveKey(key);
      });
      mo.observe(app, { childList:true, subtree:true });

      // é¦–æ¬¡é€²å…¥ï¼šä¾ hash æˆ–é è¨­ ledgers
      window.addEventListener('load', ()=>{
        const key = (location.hash||'').replace('#','') || 'ledgers';
        setActiveKey(key);
        setTimeout(()=>clickInsideAppByKey(key), 150);
      });
      window.addEventListener('hashchange', ()=>{
        const key = (location.hash||'').replace('#','') || 'ledgers';
        setActiveKey(key);
        setTimeout(()=>clickInsideAppByKey(key), 80);
      });
    })();
  </script>
</body>
</html>
